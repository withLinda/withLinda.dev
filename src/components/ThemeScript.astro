---
---
<script is:inline>
  const theme = (() => {
    if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
      return localStorage.getItem('theme');
    }
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
      return 'dark';
    }
    return 'light';
  })();

  if (theme === 'light') {
    document.documentElement.classList.remove('dark');
  } else {
    document.documentElement.classList.add('dark');
  }

  window.localStorage.setItem('theme', theme);

  // Detect contrast preference
  const contrastPreference = localStorage.getItem('contrast-preference');
  if (contrastPreference) {
    document.documentElement.setAttribute('data-contrast', contrastPreference);
  } else if (window.matchMedia('(prefers-contrast: high)').matches) {
    document.documentElement.setAttribute('data-contrast', 'hard');
  } else if (window.matchMedia('(prefers-contrast: low)').matches) {
    document.documentElement.setAttribute('data-contrast', 'soft');
  }

  // Remove no-flash class to show content
  document.documentElement.classList.remove('no-flash');
</script>
